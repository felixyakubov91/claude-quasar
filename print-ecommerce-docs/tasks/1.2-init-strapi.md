# Task 1.2: Initialize Strapi Project

## Goal
Create a new Strapi v4 project with PostgreSQL database configuration.

## Prerequisites
- Node.js 18+ installed
- PostgreSQL installed and running
- Task 1.1 completed

## Instructions

### Step 1: Create Strapi Project

```bash
cd /path/to/projects/print-ecommerce
npx create-strapi-app@latest backend --quickstart --no-run

# If you want to skip quickstart and configure manually:
npx create-strapi-app@latest backend
# Select:
# - Installation type: Custom (manual settings)
# - Database: postgres
# - Database name: print_ecommerce
# - Host: 127.0.0.1
# - Port: 5432
# - Username: your_db_user
# - Password: your_db_password
# - Enable SSL connection: No (for local dev)
```

### Step 2: Configure Database for PostgreSQL

If you used quickstart, update `backend/config/database.js`:

```javascript
module.exports = ({ env }) => ({
  connection: {
    client: 'postgres',
    connection: {
      host: env('DATABASE_HOST', '127.0.0.1'),
      port: env.int('DATABASE_PORT', 5432),
      database: env('DATABASE_NAME', 'print_ecommerce'),
      user: env('DATABASE_USERNAME', 'postgres'),
      password: env('DATABASE_PASSWORD', 'password'),
      ssl: env.bool('DATABASE_SSL', false),
    },
  },
});
```

Install PostgreSQL client:

```bash
cd backend
npm install pg
```

### Step 3: Configure Server Settings

Create/update `backend/config/server.js`:

```javascript
module.exports = ({ env }) => ({
  host: env('HOST', '0.0.0.0'),
  port: env.int('PORT', 1337),
  url: env('PUBLIC_URL', 'http://localhost:1337'),
  app: {
    keys: env.array('APP_KEYS', ['key1', 'key2']),
  },
  webhooks: {
    populateRelations: env.bool('WEBHOOKS_POPULATE_RELATIONS', false),
  },
});
```

### Step 4: Configure Admin Panel

Create `backend/config/admin.js`:

```javascript
module.exports = ({ env }) => ({
  auth: {
    secret: env('ADMIN_JWT_SECRET', 'your-admin-jwt-secret'),
  },
  apiToken: {
    salt: env('API_TOKEN_SALT', 'your-api-token-salt'),
  },
  transfer: {
    token: {
      salt: env('TRANSFER_TOKEN_SALT', 'your-transfer-token-salt'),
    },
  },
});
```

### Step 5: Create Environment File

Create `backend/.env`:

```env
HOST=0.0.0.0
PORT=1337
PUBLIC_URL=http://localhost:1337

# Database
DATABASE_CLIENT=postgres
DATABASE_HOST=127.0.0.1
DATABASE_PORT=5432
DATABASE_NAME=print_ecommerce
DATABASE_USERNAME=postgres
DATABASE_PASSWORD=your_password
DATABASE_SSL=false

# Secrets (generate unique values for production!)
APP_KEYS=key1,key2,key3,key4
ADMIN_JWT_SECRET=your-admin-jwt-secret
API_TOKEN_SALT=your-api-token-salt
JWT_SECRET=your-jwt-secret
TRANSFER_TOKEN_SALT=your-transfer-token-salt

# Cloudinary (for media uploads)
CLOUDINARY_NAME=your-cloud-name
CLOUDINARY_KEY=your-api-key
CLOUDINARY_SECRET=your-api-secret
```

### Step 6: Create PostgreSQL Database

```bash
# Using psql
psql -U postgres

CREATE DATABASE print_ecommerce;
\q
```

### Step 7: Start Strapi

```bash
cd backend
npm run develop
```

### Step 8: Create Admin User

1. Visit http://localhost:1337/admin
2. Create your first administrator account
3. Log in to the admin panel

### Step 9: Generate API Token

1. In Strapi Admin, go to Settings â†’ API Tokens
2. Click "Create new API Token"
3. Name: "Frontend API Token"
4. Token type: Full access (or Custom based on needs)
5. Copy the token and add to frontend `.env`:

```env
STRAPI_API_TOKEN=your-generated-token
```

## Files Created
- `backend/config/database.js`
- `backend/config/server.js`
- `backend/config/admin.js`
- `backend/.env`
- `backend/package.json`

## Acceptance Criteria
- [ ] `npm run develop` starts without errors
- [ ] Admin panel accessible at http://localhost:1337/admin
- [ ] Can log in with admin credentials
- [ ] PostgreSQL database created and connected
- [ ] API Token generated and working
