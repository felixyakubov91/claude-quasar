# Task 4.2: Image Editor

## Goal
Build advanced image editor with crop, rotate, filters, and text overlay.

## Instructions

### Install Dependencies
```bash
npm install vue-advanced-cropper
```

### Create ImageEditor Component
Create `frontend/src/components/upload/ImageEditor.vue`:

```vue
<template>
  <q-dialog v-model="show" maximized>
    <q-card class="column full-height">
      <q-toolbar class="bg-primary text-white">
        <q-btn flat icon="close" @click="cancel" />
        <q-toolbar-title>{{ $t('upload.editImage') }}</q-toolbar-title>
        <q-btn flat :label="$t('common.save')" @click="save" />
      </q-toolbar>

      <div class="col row">
        <!-- Tool Sidebar -->
        <div class="col-auto bg-grey-2 q-pa-md" style="width: 80px">
          <q-btn-group vertical flat>
            <q-btn icon="crop" :color="activeTool === 'crop' ? 'primary' : 'grey'" @click="activeTool = 'crop'" />
            <q-btn icon="rotate_right" :color="activeTool === 'rotate' ? 'primary' : 'grey'" @click="activeTool = 'rotate'" />
            <q-btn icon="tune" :color="activeTool === 'adjust' ? 'primary' : 'grey'" @click="activeTool = 'adjust'" />
            <q-btn icon="filter" :color="activeTool === 'filters' ? 'primary' : 'grey'" @click="activeTool = 'filters'" />
            <q-btn icon="text_fields" :color="activeTool === 'text' ? 'primary' : 'grey'" @click="activeTool = 'text'" />
          </q-btn-group>
        </div>

        <!-- Canvas Area -->
        <div class="col relative-position">
          <Cropper
            v-if="activeTool === 'crop'"
            ref="cropper"
            :src="imageUrl"
            :stencil-props="{ aspectRatio }"
            class="full-height"
          />
          <img v-else :src="previewUrl" class="fit" :style="imageStyle" />
        </div>

        <!-- Properties Panel -->
        <div class="col-auto bg-grey-1 q-pa-md" style="width: 250px">
          <!-- Crop options -->
          <div v-if="activeTool === 'crop'">
            <div class="text-subtitle2 q-mb-md">{{ $t('upload.aspectRatio') }}</div>
            <q-btn-group spread>
              <q-btn label="Free" @click="aspectRatio = null" />
              <q-btn label="1:1" @click="aspectRatio = 1" />
              <q-btn label="4:3" @click="aspectRatio = 4/3" />
            </q-btn-group>
          </div>

          <!-- Adjustments -->
          <div v-if="activeTool === 'adjust'">
            <div class="q-mb-md">
              <div class="text-caption">{{ $t('upload.brightness') }}</div>
              <q-slider v-model="adjustments.brightness" :min="-100" :max="100" />
            </div>
            <div class="q-mb-md">
              <div class="text-caption">{{ $t('upload.contrast') }}</div>
              <q-slider v-model="adjustments.contrast" :min="-100" :max="100" />
            </div>
            <div class="q-mb-md">
              <div class="text-caption">{{ $t('upload.saturation') }}</div>
              <q-slider v-model="adjustments.saturation" :min="-100" :max="100" />
            </div>
          </div>

          <!-- Filters -->
          <div v-if="activeTool === 'filters'">
            <div class="row q-col-gutter-sm">
              <div v-for="filter in filters" :key="filter.value" class="col-6">
                <q-btn
                  :label="filter.label"
                  :color="selectedFilter === filter.value ? 'primary' : 'grey'"
                  class="full-width"
                  @click="selectedFilter = filter.value"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
    </q-card>
  </q-dialog>
</template>

<script setup lang="ts">
import { ref, computed, reactive } from 'vue';
import { Cropper } from 'vue-advanced-cropper';
import 'vue-advanced-cropper/dist/style.css';

const props = defineProps<{
  modelValue: boolean;
  imageUrl: string;
}>();

const emit = defineEmits<{
  'update:modelValue': [value: boolean];
  save: [result: any];
}>();

const show = computed({
  get: () => props.modelValue,
  set: (v) => emit('update:modelValue', v),
});

const activeTool = ref('crop');
const aspectRatio = ref<number | null>(null);
const selectedFilter = ref('none');
const cropper = ref();

const adjustments = reactive({
  brightness: 0,
  contrast: 0,
  saturation: 0,
});

const filters = [
  { value: 'none', label: 'None' },
  { value: 'grayscale', label: 'B&W' },
  { value: 'sepia', label: 'Sepia' },
  { value: 'vintage', label: 'Vintage' },
];

const imageStyle = computed(() => ({
  filter: `brightness(${100 + adjustments.brightness}%) contrast(${100 + adjustments.contrast}%) saturate(${100 + adjustments.saturation}%)`,
}));

const previewUrl = computed(() => props.imageUrl);

const cancel = () => { show.value = false; };

const save = () => {
  const result = {
    crop: cropper.value?.getResult(),
    adjustments: { ...adjustments },
    filter: selectedFilter.value,
  };
  emit('save', result);
  show.value = false;
};
</script>
```

## Acceptance Criteria
- [ ] Crop tool works with aspect ratios
- [ ] Brightness/contrast adjustments work
- [ ] Filters apply correctly
- [ ] Changes can be saved
- [ ] Mobile touch support
